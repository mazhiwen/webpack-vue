<template>
  <div>
    <div id="main">

    </div>

  </div>
</template>

<script>

import graph from './data2';
export default {
  data() {
    return {
      msg: 'Hello w2222orld!',
      show:true,
    };
  },
  mounted() {
    var myChart = echarts.init(document.getElementById('main'));
    myChart.hideLoading();
    var categories = [];
    for (var i = 0; i < 9; i++) {
        categories[i] = {
            name: '类目' + i,
            // itemStyle: {
            //   color: 'rgba(128, 128, 128, 0.5)',
            // }
        };
    }
    const richLabel = {
      name: {
        fontSize: 12,
        color: '#00ee00'
      },
      text: {
        color:'#fff',
        width: '100%',
        borderColor: 'rgba(255,255,255,0.2)',
        borderWidth: 0.5,
        height: 0,
        lineHeight: 10
      }
    };
    graph.nodes.forEach(function (node) {
        // node.itemStyle = null;
        // node.symbolSize = 10;
        // node.value = node.symbolSize;
        node.symbolSize = node.value;
        // node.category = node.attributes.modularity_class;
        // Use random x, y
        // node.x = node.y = null;

        node.draggable = true;
        if(node.headImg){
          richLabel[`img${node.name}`] = {
            height: 40,
            align: 'left',
            backgroundColor: {
              image: node.headImg
            }
          }
        }
    });
    const option = {
        title: {
            text: 'Les Miserables',
            subtext: 'Default layout',
            top: 'bottom',
            left: 'right'
        },
        tooltip: {},
        legend: [{
            // selectedMode: 'single',
            data: categories.map(function (a) {
                return a.name;
            })
        }],
        
        animation: false,
        series : [
            {
                name: 'nnnnananame',
                type: 'graph',
                layout: 'force',
                data: graph.nodes,
                links: graph.links,
                categories: categories,
                roam: true,
                symbol:(value, params) => {
                    // console.log(value, params);
                    return 'path://M6.80412272,30.3633159 C6.80412272,30.3633159 7.05221722,30.1163965 7.30031172,30.1163965 C7.54832405,30.1163965 7.79641856,30.3633159 7.79641856,30.8571546 C7.79641856,37.523961 10.2772814,43.6969368 14.9909126,48.3883965 C19.4563672,53.3267756 25.9065778,55.7959643 32.3567062,56.0428853 C46.2494232,56.2898022 57.6612773,45.178453 57.6612773,31.5979045 C57.9093718,24.9310981 55.428509,18.5112029 50.7149599,13.8197432 C46.0013287,9.12828351 39.7992126,6.41217874 33.1009897,6.41217874 C32.8528952,6.41217874 32.3567062,6.16525937 32.3567062,5.67142065 C32.6048007,5.42450128 32.8528952,4.93066256 33.1009897,4.93066256 C40.0473071,5.17758192 46.7456122,7.8936867 51.7072557,12.8320657 C56.4208048,18.0173641 59.1497622,24.4372594 59.1497622,31.5979045 C58.9016677,45.9192029 46.9936245,57.5243965 32.3567062,57.2774796 C25.4103888,57.2774796 18.9601782,54.3144522 13.9985346,49.376074 C9.03689108,44.4376949 6.55602821,37.7708803 6.55602821,30.8571546 C6.55602821,30.6102352 6.55602821,30.3633159 6.80412272,30.3633159 Z,M54.2190996,10.1613395 C54.2190996,10.4091793 54.2190996,10.6570108 54.2190996,10.6570108 C53.7188839,11.1526903 53.2186682,11.1526903 52.9686014,10.6570108 C47.4662285,4.95675398 39.963075,1.73486184 32.2097724,1.73486184 C24.2064031,1.48702209 16.7031674,4.46107447 10.9507277,9.91349974 C-1.05436727,21.06619 -1.55458299,39.9018469 9.95029632,51.5502085 C15.4526692,57.2504727 22.705756,60.4723608 30.7091253,60.7201964 C38.7124946,60.9680353 46.2157303,57.9939829 51.96817,52.5415593 C52.4683857,52.2937196 52.9686014,52.2937196 53.2186682,52.5415593 C53.4688171,52.7893991 53.4688171,53.2850704 53.2186682,53.5329101 C46.9660128,59.4810116 39.2127103,62.45506 30.7091253,62.2072206 C22.4556071,61.9593852 14.4522378,58.7374973 8.69979811,52.5415593 C-3.3052969,40.1496785 -2.80508119,20.5705187 9.70022955,8.67431741 C15.702736,2.97405239 23.7061874,1.56319402e-13 32.2097724,1.56319402e-13 C40.4632907,0.247839753 48.2165932,3.71756343 54.2190996,9.66565999 C54.2190996,9.91349974 54.2190996,9.91349974 54.2190996,10.1613395 Z,M5.49486745,3.90835542 C3.26891984,6.17315665 3.26891984,10.19947 5.49486745,12.4642712 C6.9789147,13.9741387 8.95750741,14.4774278 10.9361823,14.2257915 C12.1728746,13.9741387 13.9041124,14.4774278 14.8934499,15.4840144 C15.3881597,15.9873035 15.3881597,15.9873035 15.3881597,15.9873035 C16.8721248,17.497171 17.1194797,19.7619723 15.8827873,21.5234843 C11.4308099,29.3244664 12.1728746,39.3902578 18.6034447,46.1846615 C26.2707072,53.9856436 38.6372198,54.2372881 46.3044822,46.4363061 C53.9717447,38.6353241 54.2190996,26.0530868 46.5518371,18.2521048 C40.121267,11.4576929 30.2279748,10.4511145 22.5607123,14.9807252 C20.8293924,15.9873035 18.6034447,15.735659 17.3667524,14.2257915 C16.6247699,13.7224941 16.6247699,13.7224941 16.6247699,13.7224941 C15.6354324,12.4642712 15.1408048,10.9544037 15.3881597,9.44453621 C15.8827873,7.68302414 15.3881597,5.66986749 13.9041124,4.16 C11.6781648,1.64355419 7.96816997,1.64355419 5.49486745,3.90835542 Z';
                },
                label: {
                  show:true,
                  formatter:(params)=>{
                    var arr;
                    if(params.data.headImg){
                      arr = [
                        '{img'+params.name+'|}',
                      ];
                    }else{
                      arr = [
                        '{name|'+params.name+'}',
                        '{text|'+params.data.text+'}'
                      ]
                    }
                    return arr.join('\n');
                  },
                  rich:richLabel,
                  // normal: {
                  //   show:true,
                  //   // position: 'right'
                  // }
                },
                
                force: {
                    repulsion: 100,
                    gravity:0.03,
                    edgeLength:100
                    
                }
            }
        ]
    };

    myChart.setOption(option);

  },
  
};
</script>

<style lang="less" scoped>
#main{
  width: 100%;
  height: 600px;
}

</style>
